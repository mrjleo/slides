<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Efficient Neural Ranking using Forward Indexes and Lightweight Encoders</title>
    <link rel="stylesheet" href="../node_modules/reveal.js/dist/reveal.css">
    <link rel="stylesheet" href="../node_modules/reveal.js/dist/theme/serif.css">
    <link rel="stylesheet" href="../node_modules/reveal.js/plugin/highlight/monokai.css">
    <link rel="stylesheet" href="../common.css">
    <link rel="stylesheet" href="../phd/style.css">
</head>

<body>
    <div class="reveal">
        <div class="slides">
            <!-- title -->
            <section id="title-slide">
                <div style="display: flex; justify-content: center; align-items: center; height: 2em">
                    <img style="height: 100%;" src="img/logos/luh.png">
                    <p style="margin: 0.75em"></p>
                    <img style="height: 80%;" src="img/logos/l3s.webp">
                    <p style="margin: 0.75em"></p>
                    <img style="height: 75%;" src="img/logos/tudelft.svg">
                    <p style="margin: auto"></p>
                    <img style="height: 80%;" src="img/logos/sobigdata.png">
                </div>
                <hr class="hide" style="height: 2em;">
                <h2>Efficient Neural Ranking</h2>
                <h3>using Forward Indexes and Lightweight Encoders</h3>
                <hr class="hide" style="height: 0.5em;">
                <p style="font-size: large;">
                    <b><u>Jurek Leonhardt</u></b>, Henrik MÃ¼ller, Koustav Rudra, Megha Khosla, Abhijit Anand, Avishek
                    Anand
                </p>
            </section>
            <!-- end: title -->

            <!-- background -->
            <section>
                <section id="reranking">
                    <h2>Retrieve-and-re-rank</h2>
                    <hr class="divider">
                    <p><i>Retrieve-and-re-rank</i> is a <b>telescoping</b> setting that has two stages.</p>
                    <hr class="divider">

                    <div class="column-desc-layout" id="rr-layout" style="gap: 0;">
                        <div class="column-item fragment" data-fragment-index="1">
                            <p style="font-size: 2em; margin: 0;">ðŸ“š</p>
                        </div>
                        <p class="column-label fragment" data-fragment-index="1">Corpus</p>

                        <p class="column-item rr-arrow fragment" data-fragment-index="2">â†’</p>
                        <p class="column-label fragment" data-fragment-index="2"></p>

                        <div class="column-item rr-stage fragment" data-fragment-index="2">
                            <p class="rr-stage-num">1</p>
                            <p class="rr-operation">Lexical retrieval</p>
                        </div>
                        <p class="column-label fragment" data-fragment-index="2"></p>

                        <p class="column-item rr-arrow fragment" data-fragment-index="2">â†’</p>
                        <p class="column-label fragment" data-fragment-index="2"></p>

                        <div class="column-item fragment" data-fragment-index="2" id="rr-candidate-docs">
                            ðŸ“„ðŸ“„ðŸ“„ðŸ“„ðŸ“„<br>ðŸ“„ðŸ“„ðŸ“„ðŸ“„ðŸ“„<br>ðŸ“„ðŸ“„ðŸ“„ðŸ“„ðŸ“„<br>ðŸ“„ðŸ“„ðŸ“„ðŸ“„ðŸ“„<br>ðŸ“„ðŸ“„ðŸ“„ðŸ“„ðŸ“„
                        </div>
                        <p class="column-label fragment" data-fragment-index="2">Candidates</p>

                        <p class="column-item rr-arrow fragment" data-fragment-index="3">â†’</p>
                        <p class="column-label fragment" data-fragment-index="3"></p>

                        <div class="column-item rr-stage fragment" data-fragment-index="3">
                            <p class="rr-stage-num">2</p>
                            <p class="rr-operation">Semantic re-ranking</p>
                        </div>
                        <p class="column-label fragment" data-fragment-index="3"></p>

                        <p class="column-item rr-arrow fragment" data-fragment-index="3">â†’</p>
                        <p class="column-label fragment" data-fragment-index="3"></p>

                        <div class="column-item fragment" data-fragment-index="3">
                            <p class="rr-ranking-doc">
                                #1 <span class="rr-ranking-doc-icon">ðŸ“„</span> D371 (0.95)
                            </p>
                            <p class="rr-ranking-doc">
                                #2 <span class="rr-ranking-doc-icon">ðŸ“„</span> D222 (0.85)
                            </p>
                            <p class="rr-ranking-doc">
                                #3 <span class="rr-ranking-doc-icon">ðŸ“„</span> D984 (0.71)
                            </p>
                        </div>
                        <p class="column-label fragment" data-fragment-index="3">Final ranking</p>
                    </div>
                </section>

                <section id="dense-retrieval">
                    <h2>Dense retrieval</h2>
                    <hr class="divider">
                    <div class="column-layout">
                        <div class="column-item">
                            <div class="c-wide">
                                <p>
                                    <i>Dense retrieval</i> uses <b>semantic models</b> directly for <b>retrieval</b>.
                                </p>
                                <hr class="divider">
                                <p class="fragment" data-fragment-index="2">
                                    Documents and query are embedded in a common vector space using <b>dual-encoder</b>
                                    models.
                                </p>
                                <hr class="divider">
                                <p class="fragment" data-fragment-index="3">
                                    Retrieval is performed as an (approximate) <b>nearest neighbor search</b> operation.
                                </p>
                            </div>
                        </div>
                        <div class="column-item">
                            <div class="vector-space">
                                <div class="fragment" data-fragment-index="2">
                                    <span class="dr-icon" style="top: 15rem; left: 4rem;">ðŸ“„</span>
                                    <span class="dr-icon" style="top: 3rem; left: 5rem;">ðŸ“„</span>
                                    <span class="dr-icon" style="top: 4rem; left: 7rem;">ðŸ“„</span>
                                    <span class="dr-icon" style="top: 3rem; left: 8rem;">ðŸ“„</span>
                                    <span class="dr-icon" style="top: 2rem; left: 6rem;">ðŸ“„</span>
                                    <span class="dr-icon" style="top: 8rem; left: 7rem;">ðŸ“„</span>
                                    <span class="dr-icon" style="top: 10rem; left: 9rem;">ðŸ“„</span>
                                    <span class="dr-icon" style="top: 7rem; left: 8rem;">ðŸ“„</span>
                                    <span class="dr-icon" style="top: 9rem; left: 11rem;">ðŸ“„</span>
                                    <span class="dr-icon" style="top: 10rem; left: 1rem;">ðŸ“„</span>
                                </div>
                                <div id="dr-query-radius" class="fragment" data-fragment-index="3"></div>
                                <span class="dr-icon fragment" style="top: 5rem; left: 10rem;"
                                    data-fragment-index="2">ðŸ¤”</span>
                            </div>
                            <p class="caption">The vector space is often 768-dimensional.</p>
                        </div>
                    </div>
                </section>
            </section>
            <!-- end: background -->

            <!-- fast-forward -->
            <section>
                <section id="fast-forward-motivation">
                    <h2>Motivation</h2>
                    <hr class="divider">
                    <div class="column-layout" style="grid-template-columns: auto 50%;">
                        <div class="column-item">
                            <div class="c-wide">
                                <p class="fragment" data-fragment-index="1">
                                    <span class="fragment highlight-red" data-fragment-index="1">Sparse retrieval</span>
                                    is fast, but not competitive on its own.
                                </p>
                                <hr class="divider">
                                <p class="fragment" data-fragment-index="2">
                                    Dense retrieval shows good nDCG, but recall suffers and <b>it is slow</b>.
                                </p>
                                <hr class="divider">
                                <p class="fragment" data-fragment-index="3">
                                    <span class="fragment highlight-green" data-fragment-index="3">
                                        Re-ranking using dense retrieval models
                                    </span>
                                    works well.
                                </p>
                                <hr class="divider">
                                <p class="fragment" data-fragment-index="4">
                                    <span class="fragment highlight-blue" data-fragment-index="4">
                                        Score interpolation
                                    </span>
                                    further helps:
                                </p>
                                <p class="eq fragment" data-fragment-index="4">
                                    <span class="fragment highlight-blue" data-fragment-index="4">
                                        $\phi (q, d)$
                                    </span>
                                    $= \alpha$
                                    <span class="fragment highlight-red" data-fragment-index="4">
                                        $\phi_S (q, d)$
                                    </span>
                                    $+\ (1 - \alpha) $
                                    <span class="fragment highlight-green" data-fragment-index="4">
                                        $\phi_D(q, d)$
                                    </span>
                                </p>
                            </div>
                        </div>

                        <!-- styling here is required by Safari -->
                        <div class="column-item" style="display: grid; height: 100%;">
                            <div class="tab r-stack">
                                <img class="fragment fade-out" data-fragment-index="1"
                                    src="../phd/img/fast_forward/motivation/motivation_tab_out.svg">
                                <img class="fragment fade-in-then-out" data-fragment-index="1"
                                    src="../phd/img/fast_forward/motivation/motivation_tab_1_out.svg">
                                <img class="fragment fade-in-then-out" data-fragment-index="2"
                                    src="../phd/img/fast_forward/motivation/motivation_tab_1_out.svg">
                                <img class="fragment fade-in-then-out" data-fragment-index="3"
                                    src="../phd/img/fast_forward/motivation/motivation_tab_2_out.svg">
                                <img class="fragment fade-in-then-out" data-fragment-index="4"
                                    src="../phd/img/fast_forward/motivation/motivation_tab_3_out.svg">
                            </div>
                            <p class="caption">
                                Results on the TREC Deep Learning document ranking task.
                            </p>
                        </div>
                    </div>
                </section>

                <section id="fast-forward-idea" data-auto-animate data-auto-animate-id="fast-forward">
                    <h2><span class="textsc">Fast-Forward</span> indexes</h2>
                    <hr class="divider">
                    <p>
                        $\phi (q, d) = \alpha \cdot \phi_S (q, d) + (1 - \alpha) \ \cdot $
                        <span class="fragment highlight-green" data-fragment-index="1">$\phi_D(q, d)$</span>
                    </p>
                    <p class="fragment" data-fragment-index="1">
                        Our approach:
                        <b class="fragment highlight-green" data-fragment-index="1">
                            Efficient re-ranking with dual encoders</b>.
                    </p>
                    <hr class="divider">
                    <p class="fragment" data-fragment-index="2">
                        A <b><span class="textsc">Fast-Forward</span> index</b> is a look-up table for pre-computed
                        document representations:
                    </p>
                    <p class="fragment" data-fragment-index="2">
                        <span class="fragment highlight-green" data-fragment-index="2">
                            $\phi_D^{FF} (q, d)$
                        </span>
                        $= \zeta (q) \cdot \eta^{FF} (d) $
                    </p>
                </section>

                <section id="fast-forward-efficiency" data-auto-animate data-auto-animate-id="fast-forward">
                    <h2><span class="textsc">Fast-Forward</span> indexes</h2>
                    <hr class="divider">
                    <p>
                        The <b>look-up</b> operation is much more <b>efficient</b> than actual re-ranking:
                    </p>
                    <hr class="divider">
                    <img class="fig" src="../phd/img/fast_forward/results/comparison_out.svg" style="margin: 0;">
                    <p class="caption">
                        TCT-ColBERT on the TREC-DL 2019 document ranking task.
                    </p>
                </section>

                <section id="fast-forward-results">
                    <h2>Passage ranking results</h2>
                    <hr class="divider">
                    <img class="fig" style="margin: 0;" src="../phd/img/fast_forward/results/passage_ranking_out.svg">
                    <p class="caption">Passage ranking results. Latency measured on CPU.</p>
                    <hr class="divider">
                    <p class="fragment">
                        <b>Coming up</b>: Techniques to improve efficiency even further.
                    </p>
                </section>

                <section id="fast-forward-maxp">
                    <h2>MaxP indexes</h2>
                    <hr class="divider">
                    <p>
                        Long documents are often chunked into passages and scored using a $\max$ operation:
                    </p>
                    <p>
                        $\phi_D^{FF} (q, d) = \max_{p_i \in d} (\zeta (q) \cdot \eta^{FF} (p_i))$
                    </p>
                    <hr class="divider">
                    <p class="fragment">
                        We propose <b>sequential coalescing</b> to compress maxP indexes.
                    </p>
                </section>

                <section id="fast-forward-sc" data-auto-animate data-auto-animate-id="sc">
                    <h2>Sequential coalescing</h2>
                    <hr class="divider">
                    <div class="column-layout" style="grid-template-columns: 45% auto;">
                        <div class="column-item">
                            <img class="fig" src="../phd/img/fast_forward/coalescing_out.svg">
                            <p class="caption">Look-up operation in a coalesced index.</p>
                        </div>
                        <div class="column-item">
                            <div class="c-wide">
                                <p>
                                    Long documents are often chunked into passages, so they have <b>multiple
                                        representations</b>.
                                </p>
                                <p class="fragment">
                                    <i>Sequential coalescing</i> <b>merges similar representations</b> of subsequent
                                    passages within a document.
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="fast-forward-sc-effects" data-auto-animate data-auto-animate-id="sc">
                    <h2>Sequential coalescing</h2>
                    <hr class="divider">
                    <img class="fig" src="../phd/img/fast_forward/results/coalescing_out.svg">
                    <p class="caption">
                        TCT-ColBERT on TREC-DL 2019 document ranking with sequential coalescing.
                    </p>
                </section>

                <section id="fast-forward-sc-results" data-auto-animate data-auto-animate-id="sc">
                    <h2>Sequential coalescing</h2>
                    <hr class="divider">
                    <img class="fig" style="margin: 0;" src="img/results/doc_ranking_coalescing_out.svg">
                    <p class="caption">Results on the TREC-DL 2019 document ranking task.</p>
                </section>

                <section id="fast-forward-es-idea" data-auto-animate data-auto-animate-id="es">
                    <h2>Early stopping</h2>
                    <hr class="divider">
                    <p>
                        Many tasks require only a <b>small number of documents</b> (e.g., the top-$10$).
                    </p>
                    <hr class="divider">
                    <p class="fragment" data-fragment-index="1">
                        <b>Lexical</b> (sparse) and <b>semantic</b> (dense) scores are <b>usually correlated</b>.
                    </p>
                    <p class="fragment" data-fragment-index="1">
                        In many cases, it is <b>not necessary to compute all semantic scores</b>.
                    </p>
                    <hr class="divider">
                    <p class="fragment" data-fragment-index="2">
                        We propose an approach for <b>early stopping</b>.
                    </p>
                </section>

                <section id="fast-forward-es">
                    <h2>Early stopping</h2>
                    <hr class="divider">
                    <img class="fig" src="../phd/img/fast_forward/early_stopping_out.svg">
                    <p class="caption">The <i>early stopping</i> approach illustrated.</p>
                </section>

                <section id="fast-forward-es-effects" data-auto-animate data-auto-animate-id="es">
                    <h2>Early stopping</h2>
                    <hr class="divider">
                    <img class="fig" src="../phd/img/fast_forward/results/early_stopping_out.svg">
                    <p class="caption">ANCE on TREC-DL 2019 passage ranking with early stopping.</p>
                </section>

                <section id="fast-forward-es-results" data-auto-animate data-auto-animate-id="es">
                    <h2>Early stopping</h2>
                    <hr class="divider">
                    <img class="fig" style="margin: 0;"
                        src="../phd/img/fast_forward/results/passage_ranking_early_stopping_out.svg">
                    <p class="caption">Results on the TREC-DL 2019 passage ranking task.</p>
                </section>

                <section id="fast-forward-encoders">
                    <h2>Efficient encoders</h2>
                    <hr class="divider">
                    <p>Queries and documents have <b>different characteristics</b> in terms of length and complexity.
                    </p>
                    <img class="fig fragment" data-fragment-index="1"
                        src="../phd/img/fast_forward/length_stats_out.svg">
                    <p class="caption fragment" data-fragment-index="1">The distribution of query and passage lengths in
                        the MS MARCO corpus.</p>
                    <hr class="divider">
                    <p class="fragment">We propose encoders to deal with these charactertistics <b>more efficiently</b>.
                    </p>
                </section>

                <section id="fast-forward-query-encoders" data-auto-animate data-auto-animate-id="qenc">
                    <h2>Efficient query encoders</h2>
                    <hr class="divider">
                    <p>
                        Queries are <b>short</b> and <b>concise</b>, but query encoders are usually based on <b>complex
                            self-attention-based Transformer</b> models.
                    </p>
                    <hr class="divider">
                    <div class="column-layout fragment">
                        <div class="column-item">
                            <img class="fig" src="../phd/img/fast_forward/query_encoder_out.svg">
                            <p class="caption">Self-attention-based query encoder.</p>
                        </div>
                        <div class="column-item">
                            <div class="c-wide">
                                <p>Hyperparameters:</p>
                                <ul>
                                    <li>Number of layers $L$</li>
                                    <li>Number of attention heads $A$</li>
                                    <li>Representation size $H$</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <hr class="divider">
                    <p class="fragment">
                        $\text{BERT}_\text{base}$: $L=12$, $A=12$, $H=768$.
                        <span class="fragment"><b>Can we go lower?</b></span>
                    </p>
                </section>

                <section id="fast-forward-query-encoders-results" data-auto-animate data-auto-animate-id="qenc">
                    <h2>Efficient query encoders</h2>
                    <hr class="divider">
                    <p>Lightweight query encoders can achieve similar performance, but it depends on the dataset:</p>
                    <div class="column-layout">
                        <div class="column-item fragment custom grow-active">
                            <img class="fig" src="../phd/img/fast_forward/results/query_encoders/latency_out.svg">
                            <p class="caption">
                                Query encoding latency in seconds.
                            </p>
                        </div>
                        <div class="column-item fragment custom grow-active">
                            <img class="fig" src="../phd/img/fast_forward/results/query_encoders/msmpsgdev_out.svg">
                            <p class="caption">
                                nDCG@10 on <span class="textsc">MSM-Psg-Dev</span>.
                            </p>
                        </div>
                        <div class="column-item fragment custom grow-active">
                            <img class="fig" src="../phd/img/fast_forward/results/query_encoders/trecdspsg19_out.svg">
                            <p class="caption">
                                nDCG@10 on <span class="textsc">TREC-DL-Psgâ€™19</span>.
                            </p>
                        </div>
                        <div class="column-item fragment custom grow-active">
                            <img class="fig" src="../phd/img/fast_forward/results/query_encoders/trecdlpsg20_out.svg">
                            <p class="caption">
                                nDCG@10 on <span class="textsc">TREC-DL-Psgâ€™20</span>.
                            </p>
                        </div>
                    </div>
                </section>

                <section id="fast-forward-document-encoders" data-auto-animate data-auto-animate-id="denc">
                    <h2>Selective document encoders</h2>
                    <hr class="divider" data-fragment-index="1">
                    <div class="column-layout" style="grid-template-columns: 60% auto;">
                        <div class="column-item">
                            <div class="c-wide">
                                <p>Documents are often long; <b>encoding</b> (indexing) is expensive.</p>
                                <hr class="divider">
                                <p class="fragment" data-fragment-index="1">
                                    <b>Complex encoders</b> are required to capture the semantics of the documents.
                                </p>
                                <hr class="divider">
                                <p class="fragment" data-fragment-index="2">
                                    Can we <b>shorten documents</b> instead?
                                </p>
                            </div>
                        </div>

                        <div class="column-item">
                            <p class="fig"
                                style="font-family: monospace; text-align: left; border: 0.1em solid gray; border-radius: 0.5em; padding: 1em; background-color: white;">
                                [...]
                                <br>
                                <br>
                                <span class="fragment fade-out" data-fragment-index="4">
                                    <span class="fragment highlight-red" data-fragment-index="3">
                                        This is a
                                    </span>
                                </span>
                                web article
                                <span class="fragment fade-out" data-fragment-index="4">
                                    <span class="fragment highlight-red" data-fragment-index="3">
                                        which is
                                    </span>
                                </span>
                                unnecessarily long
                                <span class="fragment fade-out" data-fragment-index="4">
                                    <span class="fragment highlight-red" data-fragment-index="3">
                                        and
                                    </span>
                                </span>
                                contains
                                <span class="fragment fade-out" data-fragment-index="4">
                                    <span class="fragment highlight-red" data-fragment-index="3">
                                        ads, repetitions, and, finally, some
                                    </span>
                                </span>
                                useful content.
                                <br>
                                <br>
                                [...]
                            </p>
                            <p class="caption">Example document.</p>
                        </div>
                    </div>
                </section>

                <section id="fast-forward-selective-document-encoders" data-auto-animate data-auto-animate-id="denc">
                    <h2>Selective document encoders</h2>
                    <hr class="divider">
                    <div class="column-layout" style="grid-template-columns: 50% auto;">
                        <div class="column-item">
                            <img class="fig" src="../phd/img/fast_forward/selbert_out.svg">
                            <p class="caption">Selective document encoder.</p>
                        </div>
                        <div class="column-item">
                            <div class="c-wide">
                                <p>
                                    <i>Selective document encoders</i> <b>dynamically shorten</b> batches of input
                                    documents
                                    during inference.
                                </p>
                                <hr class="divider">
                                <p class="fragment">
                                    Each <b>document token</b> is assigned a score, and the <b>lowest scoring tokens are
                                        removed</b>.
                                </p>
                                <hr class="divider">
                                <p class="fragment">
                                    The degree to which documents are shortened is controlled by a hyperparameter
                                    $p \in [0,1]$.
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="fast-forward-selective-document-encoders-results" data-auto-animate
                    data-auto-animate-id="denc">
                    <h2>Selective document encoders</h2>
                    <hr class="divider">
                    <p>
                        Selective document encoders incur a <b>small performance hit</b>, but <b>decrease the indexing
                            latency</b> notably:
                    </p>
                    <div class="column-layout">
                        <div class="column-item">
                            <img class="fig" src="../phd/img/fast_forward/results/doc_encoders/latency_out.svg">
                            <p class="caption">
                                Encoding latency, batch size: 256.
                            </p>
                        </div>
                        <div class="column-item">
                            <img class="fig" src="../phd/img/fast_forward/results/doc_encoders/attn_out.svg">
                            <p class="caption">
                                Performance on <span class="textsc">MSM-Psg-Dev</span>.
                            </p>
                        </div>
                    </div>
                </section>

                <section id="fast-forward-summary">
                    <h2>Summary</h2>
                    <hr class="divider">
                    <ul>
                        <li>
                            We proposed <span class="textsc">Fast-Forward</span> indexes for efficient and effective
                            neural re-ranking.
                        </li>
                        <li>
                            We showed how efficiency can be improved using <i>early stopping</i> and <i>sequential
                                coalescing</i> techniques.
                        </li>
                        <li>
                            We introduced lightweight encoders for both queries and documents.
                        </li>
                    </ul>
                    <hr class="divider">
                    <div class="github-container">
                        <img class="github-qr" src="../phd/img/fast_forward/qr_github.svg">
                        <a class="github-url"
                            href="https://github.com/mrjleo/fast-forward-indexes">mrjleo/fast-forward-indexes</a>
                    </div>
                </section>
            </section>
            <!-- end: fast-forward -->

            <!-- backup -->
            <section>
                <section class="sec-title" id="backup">
                    <h2>
                        <b>Backup slides</b>
                    </h2>
                </section>

                <section id="fast-forward-sc-demo">
                    <h2>Sequential coalescing</h2>

                    <hr class="divider">
                    <div class="column-layout" style="grid-template-columns: 40% auto;">
                        <div class="column-item">
                            <!-- the blank character &zwnj; is necessary for Safari to render animations correctly -->
                            <div class="vector-space">
                                <div class="sc-psg-container fragment fade-out" style="top: 14rem; left: 8rem;"
                                    data-fragment-index="3">
                                    <p class="sc-psg before fragment highlight-red" data-fragment-index="1">&zwnj;
                                    </p>
                                    <p class="sc-psg-label">$p_0$</p>
                                </div>

                                <div class="sc-psg-container fragment fade-out" style="top: 13rem; left: 12rem;"
                                    data-fragment-index="3">
                                    <p class="sc-psg before fragment highlight-red" data-fragment-index="2">&zwnj;
                                    </p>
                                    <p class="sc-psg-label">$p_1$</p>
                                </div>

                                <div class="fragment fade-out" data-fragment-index="5">
                                    <div class="sc-psg-container fragment fade-in" style="top: 13.5rem; left: 10rem;"
                                        data-fragment-index="3">
                                        <p class="sc-psg after fragment highlight-red" data-fragment-index="3">
                                            &zwnj;
                                        </p>
                                        <p class="sc-psg-label">$\mathcal{A}$</p>
                                    </div>
                                </div>

                                <div class="sc-psg-container fragment fade-out" style="top: 10rem; left: 9.5rem;"
                                    data-fragment-index="5">
                                    <p class="sc-psg before fragment highlight-red" data-fragment-index="4">&zwnj;
                                    </p>
                                    <p class="sc-psg-label">$p_2$</p>
                                </div>

                                <div class="fragment fade-out" data-fragment-index="7">
                                    <div class="sc-psg-container fragment fade-in"
                                        style="top: 12.333rem; left: 9.8333rem;" data-fragment-index="5">
                                        <p class="sc-psg after fragment highlight-red" data-fragment-index="5">
                                            &zwnj;
                                        </p>
                                        <p class="sc-psg-label">$\mathcal{A}$</p>
                                    </div>
                                </div>

                                <div class="sc-psg-container fragment fade-in " style="top: 12.333rem; left: 9.8333rem;"
                                    data-fragment-index="7">
                                    <p class="sc-psg after">&zwnj;</p>
                                    <p class="sc-psg-label">$\hat{p}_1$</p>
                                </div>

                                <div class="sc-psg-container fragment fade-out" style="top: 8rem; left: 2rem;"
                                    data-fragment-index="9">
                                    <p class="sc-psg before fragment highlight-red" data-fragment-index="6">&zwnj;
                                    </p>
                                    <p class="sc-psg-label">$p_3$</p>
                                </div>
                                <div class="sc-psg-container fragment fade-in" style="top: 8rem; left: 2rem;"
                                    data-fragment-index="9">
                                    <p class="sc-psg after">&zwnj;</p>
                                    <p class="sc-psg-label">$\hat{p}_2$</p>
                                </div>

                                <div class="sc-psg-container fragment fade-out" style="top: 4rem; left: 13rem;"
                                    data-fragment-index="11">
                                    <p class="sc-psg before fragment highlight-red" data-fragment-index="8">&zwnj;
                                    </p>
                                    <p class="sc-psg-label">$p_4$</p>
                                </div>
                                <div class="sc-psg-container fragment fade-in" style="top: 4rem; left: 13rem;"
                                    data-fragment-index="11">
                                    <p class="sc-psg after" data-fragment-index="8">&zwnj;</p>
                                    <p class="sc-psg-label">$\hat{p}_3$</p>
                                </div>

                                <div class="sc-psg-container fragment fade-out" style="top: 5rem; left: 0rem;"
                                    data-fragment-index="13">
                                    <p class="sc-psg before fragment highlight-red" data-fragment-index="10">&zwnj;
                                    </p>
                                    <p class="sc-psg-label">$p_5$</p>
                                </div>

                                <div class="sc-psg-container fragment fade-out" style="top: 4rem; left: 3rem;"
                                    data-fragment-index="13">
                                    <p class="sc-psg before fragment highlight-red" data-fragment-index="12">&zwnj;
                                    </p>
                                    <p class="sc-psg-label">$p_6$</p>
                                </div>

                                <div class="fragment fade-out" data-fragment-index="14">
                                    <div class="sc-psg-container fragment fade-in" style="top: 4.5rem; left: 1.5rem;"
                                        data-fragment-index="13">
                                        <p class="sc-psg after fragment highlight-red" data-fragment-index="13">
                                            &zwnj;
                                        </p>
                                        <p class="sc-psg-label">$\mathcal{A}$</p>
                                    </div>
                                </div>

                                <div class="sc-psg-container fragment fade-in" style="top: 4.5rem; left: 1.5rem;"
                                    data-fragment-index="14">
                                    <p class="sc-psg after">&zwnj;</p>
                                    <p class="sc-psg-label">$\hat{p}_4$</p>
                                </div>
                            </div>

                            <p class="caption">
                                All passage representations of a document in the embedding space.
                            </p>
                        </div>

                        <div class="column-item">
                            <pre class="python" style="font-size: large; line-height: 1.5em;">
								<code data-trim data-noescape style="border-radius: 0.5em;" data-line-numbers="|6,7,8,12,13|9|12,13|9|12,13|9|10,11,12,13|9|10,11,12,13|9|10,11,12,13|9|12,13|14,15" data-fragment-index="1">
									def coalesce(P):
										P_new = []
										A = []
										A_avg = None
										first_iteration = True
										for p in P:
											if first_iteration:
												first_iteration = False
											elif distance(p, A_avg) >= delta:
												P_new.append(A_avg)
												A = []
											A.append(p)
											A_avg = np.mean(A, axis=0)
										P_new.append(A_avg)
										return P_new
								</code>
							</pre>
                        </div>
                    </div>
                </section>

                <section id="fast-forward-es-demo" data-auto-animate data-auto-animate-id="es">
                    <h2>Early stopping ($k=3$)</h2>
                    <hr class="divider">
                    <div class="column-layout">
                        <div class="column-item" id="es-example-left-col">
                            <div class="c-wide">
                                <p>
                                    We set $\alpha = 0.5$:
                                </p>
                                <p class="eq">
                                    $\phi (q, d) = 0.5 \cdot \phi_S (q, d) + 0.5 \cdot \phi_D (q, d)$
                                </p>
                                <hr class="divider">
                                <p class="hide">
                                    <i>
                                        Stop the computation once the <b>highest possible score</b>
                                        $\phi_{\text{max}} (q, d)$ is <b>too low to make a difference</b>.
                                    </i>
                                </p>
                                <hr class="divider">
                                <p class="hide">
                                    $\phi_D$ is <b>not normalized</b>. We <b>approximate its maximum</b> as the
                                    <b>highest observed score</b>:
                                </p>
                                <p class="hide">
                                    $\phi_{\text{max}} (q, \text{D224}) = 0.5 \cdot 0.73 + 0.5 \cdot 0.67 = 0.70$
                                </p>
                            </div>
                        </div>
                        <div class="column-item" id="es-example-right-col">
                            <table class="tab" id="es-tab">
                                <thead data-id="es-tab-head">
                                    <tr>
                                        <th></th>
                                        <th>$\phi_S$</th>
                                        <th>$\phi_D$</th>
                                        <th>$\phi$ â†“</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <ul>
                                                <li>D123</li>
                                                <li>D215</li>
                                                <li>D300</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul>
                                                <li>0.89</li>
                                                <li>0.85</li>
                                                <li>0.81</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul class="fragment" data-fragment-index="1">
                                                <li>0.61</li>
                                                <li>0.51</li>
                                                <li>0.67</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul class="fragment" data-fragment-index="1">
                                                <li>0.75</li>
                                                <li>0.68</li>
                                                <li>0.74</li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr class="hide">
                                        <td>
                                            <ul>
                                                <li>x</li>
                                                <li>x</li>
                                                <li>x</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul>
                                                <li>x</li>
                                                <li>x</li>
                                                <li>x</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul>
                                                <li>x</li>
                                                <li>x</li>
                                                <li>x</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul>
                                                <li>x</li>
                                                <li>x</li>
                                                <li>x</li>
                                            </ul>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <p class="caption">Ranked documents.</p>
                        </div>
                    </div>
                </section>

                <section id="fast-forward-es-demo" data-auto-animate data-auto-animate-id="es">
                    <h2>Early stopping ($k=3$)</h2>
                    <hr class="divider">
                    <div class="column-layout">
                        <div class="column-item" id="es-example-left-col">
                            <div class="c-wide">
                                <p>
                                    We set $\alpha = 0.5$:
                                </p>
                                <p class="eq">
                                    $\phi (q, d) = 0.5 \cdot \phi_S (q, d) + 0.5 \cdot \phi_D (q, d)$
                                </p>
                                <hr class="divider">
                                <p class="fragment" data-fragment-index="2">
                                    <i>
                                        Stop the computation once the <b>highest possible score</b>
                                        $\phi_{\text{max}} (q, d)$ is <b>too low to make a difference</b>.
                                    </i>
                                </p>
                                <hr class="divider">
                                <p class="fragment" data-fragment-index="3">
                                    $\phi_D$ is <b>not normalized</b>. We <b>approximate its maximum</b> as the
                                    <span class="fragment highlight-green" data-fragment-index="3">
                                        <b>highest observed score</b></span>:
                                </p>
                                <p class="fragment eq" data-fragment-index="4">
                                    $\phi_{\text{max}} (q, \text{D224}) = 0.5\ \cdot$
                                    <span class="fragment highlight-red" data-fragment-index="4">$0.73$</span>
                                    $ +\ 0.5\ \cdot$
                                    <span class="fragment highlight-green" data-fragment-index="4">$0.67$</span>
                                    $ \gt $
                                    <span class="fragment highlight-blue" data-fragment-index="4">$0.68$</span>
                                </p>
                            </div>
                        </div>
                        <div class="column-item" id="es-example-right-col">
                            <table id="es-tab" class="tab">
                                <thead data-id="es-tab-head">
                                    <tr>
                                        <th></th>
                                        <th>$\phi_S$</th>
                                        <th>$\phi_D$</th>
                                        <th>$\phi$ â†“</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <ul>
                                                <li>D123</li>
                                                <li>D300</li>
                                                <li>D215</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul>
                                                <li>0.89</li>
                                                <li>0.81</li>
                                                <li>0.85</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul>
                                                <li>0.61</li>
                                                <li>
                                                    <span class="fragment highlight-green" data-fragment-index="3">
                                                        0.67
                                                    </span>
                                                </li>
                                                <li>0.51</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul>
                                                <li>0.75</li>
                                                <li>0.74</li>
                                                <li>
                                                    <span class="fragment highlight-blue" data-fragment-index="4">
                                                        0.68
                                                    </span>
                                                </li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr class="fragment" data-fragment-index="1">
                                        <td>
                                            <ul>
                                                <li>D224</li>
                                                <li>D105</li>
                                                <li>D900</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul>
                                                <li>
                                                    <span class="fragment highlight-red" data-fragment-index="4">
                                                        0.73
                                                    </span>
                                                </li>
                                                <li>0.49</li>
                                                <li>0.42</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul>
                                                <li class="fragment" data-fragment-index="5">0.71</li>
                                                <li class="hide">x</li>
                                                <li class="hide">x</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul>
                                                <li class="fragment" data-fragment-index="5">0.72</li>
                                                <li class="hide">x</li>
                                                <li class="hide">x</li>
                                            </ul>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <p class="caption">Ranked documents.</p>
                        </div>
                    </div>
                </section>

                <section id="fast-forward-es-demo" data-auto-animate data-auto-animate-id="es">
                    <h2>Early stopping ($k=3$)</h2>
                    <hr class="divider">
                    <div class="column-layout">
                        <div class="column-item" id="es-example-left-col">
                            <div class="c-wide">
                                <p>
                                    We set $\alpha = 0.5$:
                                </p>
                                <p class="eq">
                                    $\phi (q, d) = 0.5 \cdot \phi_S (q, d) + 0.5 \cdot \phi_D (q, d)$
                                </p>
                                <hr class="divider">
                                <p>
                                    <i>
                                        Stop the computation once the <b>highest possible score</b>
                                        $\phi_{\text{max}} (q, d)$ is <b>too low to make a difference</b>.
                                    </i>
                                </p>
                                <hr class="divider">
                                <p>
                                    $\phi_D$ is <b>not normalized</b>. We <b>approximate its maximum</b> as the
                                    <span class="fragment highlight-green" data-fragment-index="1">
                                        <b>highest observed score</b></span>:
                                </p>
                                <p class="fragment eq" data-fragment-index="1">
                                    $\phi_{\text{max}} (q, \text{D105}) = 0.5\ \cdot$
                                    <span class="fragment highlight-red" data-fragment-index="1">$0.49$</span>
                                    $ +\ 0.5\ \cdot$
                                    <span class="fragment highlight-green" data-fragment-index="1">$0.71$</span>
                                    $ \lt $
                                    <span class="fragment highlight-blue" data-fragment-index="1">$0.72$</span>
                                </p>
                            </div>
                        </div>
                        <div class="column-item" id="es-example-right-col">
                            <table class="tab" id="es-tab">
                                <thead data-id="es-tab-head">
                                    <tr>
                                        <th></th>
                                        <th>$\phi_S$</th>
                                        <th>$\phi_D$</th>
                                        <th>$\phi$ â†“</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <ul>
                                                <li>D123</li>
                                                <li>D300</li>
                                                <li>D224</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul>
                                                <li>0.89</li>
                                                <li>0.81</li>
                                                <li>0.73</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul>
                                                <li>0.61</li>
                                                <li>0.67</li>
                                                <li>
                                                    <span class="fragment highlight-green" data-fragment-index="1">
                                                        0.71
                                                    </span>
                                                </li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul>
                                                <li>0.75</li>
                                                <li>0.74</li>
                                                <li>
                                                    <span class="fragment highlight-blue" data-fragment-index="1">
                                                        0.72
                                                    </span>
                                                </li>
                                            </ul>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <ul>
                                                <li>D215</li>
                                                <li>D105</li>
                                                <li>D900</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul>
                                                <li>0.85</li>
                                                <li>
                                                    <span class="fragment highlight-red" data-fragment-index="1">
                                                        0.49
                                                    </span>
                                                </li>
                                                <li>0.42</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul>
                                                <li>0.51</li>
                                                <li class="hide">x</li>
                                                <li class="hide">x</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul>
                                                <li>0.68</li>
                                                <li class="hide">x</li>
                                                <li class="hide">x</li>
                                            </ul>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <p class="caption">Ranked documents.</p>
                        </div>
                    </div>
                </section>
            </section>
            <!-- end: backup -->
        </div>
    </div>

    <script src="../node_modules/reveal.js/dist/reveal.js"></script>
    <script src="../node_modules/reveal.js/plugin/markdown/markdown.js"></script>
    <script src="../node_modules/reveal.js/plugin/highlight/highlight.js"></script>
    <script src="../node_modules/reveal.js/plugin/math/math.js"></script>
    <script src="../node_modules/reveal.js/plugin/zoom/zoom.js"></script>
    <script src="../node_modules/reveal.js/plugin/notes/notes.js"></script>
    <script>
        Reveal.initialize({
            hash: true,
            slideNumber: true,
            katex: {
                local: "../node_modules/katex",
            },
            plugins: [RevealMarkdown, RevealHighlight, RevealMath.KaTeX, RevealZoom, RevealNotes]
        });
    </script>
</body>

</html>